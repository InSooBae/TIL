# CPU 스케줄러

Created Time: November 16, 2022 2:52 AM
Status: 🛠 In Progress

## CPU Scheduler vs Dispatcher

![출처 : [https://www.cs.uic.edu/~jbell/CourseNotes/OperatingSystems/3_Processes.html](https://www.cs.uic.edu/~jbell/CourseNotes/OperatingSystems/3_Processes.html)](CPU%20%E1%84%89%E1%85%B3%E1%84%8F%E1%85%A6%E1%84%8C%E1%85%AE%E1%86%AF%E1%84%85%E1%85%A5%20a4610be37997470abe97c7eb99015043/Untitled.png)

출처 : [https://www.cs.uic.edu/~jbell/CourseNotes/OperatingSystems/3_Processes.html](https://www.cs.uic.edu/~jbell/CourseNotes/OperatingSystems/3_Processes.html)

### CPU scheduler

위 그림은 프로세스의 상태 변화이다. 여기서 `scheduler dispatch` 중 `scheduler` 을 살펴보자.

여기서 `scheduler` 는 CPU가 놀지않고 항상 일할 수 있도록 `프로세스`를 `선택`하는 역할을 한다.

예를 들어 현재 어떤 프로세스가 `running` 상태에서 실행되다가 여러가지 이유로 실행되던 프로세스가 다른 상태로 바뀌게 됐다고 보자.(`ready` or `terminated` or `waiting`)

이때 CPU가 비어있게 되는데, 해당 CPU가 비어있지 않고 `이어서 다른 프로세스가 실행`될 수 있도록 해야한다.

그럼 어떤 프로세스가 실행될 수 있도록 할 것인지 `선택`하는 역할을 `scheduler`가 한다.

`ready` 상태에서 기다리는 프로세스들이 대부분 많을 텐데, `해당 프로세스들(ready 상태 있는 프로세스들)`을 모아두는 `queue`가 있다. 이것을 `ready queue`라고 함.

그래서 `ready queue`에 앞으로 `CPU에서 실행되기 원하는 프로세스`들이 기다리고 있다.

`scheduler`는 이 `ready queue`에서 다음 번에 `어떤 프로세스`가 `CPU에서 실행`되야할 지 `선택`하는 역할을 하게 된다.

`Scheduler` 요약

- `CPU`에서 `실행될 프로세스`를 `선택`하는 역할

### Dispatcher

이번엔 `scheduler dispatch` 중 `dispatcher`을 살펴보자.(여기선 `dispatch`라고 써있는데 같다고 봐도 무관)

`scheduler`가 다음 번에 CPU에서 실행되야할 프로세스를 선택후, `dispatcher`는 그렇게 선택된 프로세스를 실제로 `CPU`에서 `실행될 수` 있도록 하는 `역할`을 한다.

그럼 `dispatcher`는 어떤 작업이 있냐면, `Context Switching`  하는 역할을 `dispatcher`가 한다.

이미 `CPU에서 실행되고 있던 프로세스`를 방금 전에 `scheduler`가 `선택한 프로세스`로 바꾸는 `Context-switching` 역할을 `dispatcher`가 하게 된다.

그렇게 바꾸고 나서 지금 `Context-Switching`같은 경우 `CPU`와 관련된 `작업`이라 대단히 `민감한 작업`이다.

이런 민감한 작업은 `OS`에서 `조심스럽게` 다뤄져야하는 `작업`이기 때문에 `Kernel 모드`에서 `실행`이 된다.

그렇게 `Kernel 모드`에서 `Context-Switching`이 끝이 나고, 새롭게 선택된 프로세스가 실행이 되야한다.

새롭게 `선택된 프로세스`가 `실행`될 수 있도록 다시 `User 모드`로 `전환`이 된다.

그래서 `CPU Control(제어권)`을 새롭게 `선택된 프로세스`에게 넘겨준다.

`Dispatcher` 요약

- 이렇게 `Kernel 모드` → `User 모드`로 전환하는 역할
- 새롭게 `선택된 프로세스`가 `어디서부터 작업`을 `시작`해야 될 지 실행돼야할 `적절한 위치`로 선택된 프로세스를 `이동`시키는 역할
- 결론은 `선택된 프로세스`에게 `CPU`를 `할당`하는 역할

## 스케줄링의 선점 방식